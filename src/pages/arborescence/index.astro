---
import { getCollection } from 'astro:content';
import A4Layout from '../../layouts/A4.astro';

// 1. Au lieu de chercher une aiguille précise, on récupère toute la botte de foin
const allEntries = await getCollection('guide');

// 2. On cherche le fichier qui correspond à l'arborescence
// On teste plusieurs possibilités pour être sûr de le trouver
const entry = allEntries.find(e => 
  e.slug === 'arborescence' || 
  e.slug === 'arborescence/index' ||
  e.id === 'arborescence/index.md'
);

if (!entry) {
  // Si on est ici, c'est que le fichier n'est VRAIMENT pas dans src/content/guide/
  throw new Error(`
    ⚠️ Fichier introuvable ! 
    Assurez-vous que le fichier 'index.md' existe bien dans le dossier :
    'src/content/guide/arborescence/'
  `);
}

const { Content } = await entry.render();
---

<A4Layout info={entry} niveau="Ressource" theme="Général" sousTheme="Navigation">
  <article class="etiquette format-1_1">
    <header class="etiquette-header">
      <h2 class="etiquette-title">{entry.data.title}</h2>
    </header>
    
    <section class="etiquette-section section-texte">
      <div class="arborescence-container">
        <Content />
      </div>
    </section>
  </article>
</A4Layout>

<style>
  .arborescence-container :global(pre) {
    background: #f1f5f9;
    padding: 1rem;
    border-radius: 0.5rem;
    border: 1px solid #cbd5e1;
    font-family: monospace;
    font-size: 0.9rem;
    line-height: 1.4;
    white-space: pre-wrap;
  }
</style>