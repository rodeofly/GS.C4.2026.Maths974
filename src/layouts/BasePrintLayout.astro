---
import '../styles/main.css';
import Navbar from '../components/Navbar.astro';
import SubthemeInfo from '../components/SubthemeInfo.astro';

const { info, title, layoutClass, niveauLabel, indexContent, themeLabel } = Astro.props;
const base = import.meta.env.BASE_URL.replace(/\/$/, '');

const path = Astro.url.pathname;
const isRapido = path.includes('/rapidos/');
const rootLabel = isRapido ? 'Rapidos' : 'Guide';
const rootUrl = isRapido ? `${base}/rapidos/` : `${base}/guide/`;

const slug = info?.slug?.replace(/\/index$/, '') || '';
const niveauSlug = slug.split('/')[0];
---
<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <link rel="icon" type="image/svg+xml" href={`${base}/favicon.svg`} />
    <link rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css" />
    <script is:inline>
      window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }, svg: { fontCache: 'global' } };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg-full.js" defer></script>
    <script src="https://tikzjax.com/v1/tikzjax.js" defer></script>
  </head>
  <body class={`layout ${layoutClass}`}>
    <Navbar title={title} />
    
    <header class="layout-header-simple">
      <nav class="breadcrumb no-print" aria-label="Fil d'ariane">
        <ol>
          <li><a href={`${base}/`}>Accueil</a></li>
          {slug !== "" && slug !== "index" && (
            <>
              <li class="separator">/</li>
              <li><a href={rootUrl}>{rootLabel}</a></li>
            </>
          )}
          {niveauLabel && niveauSlug && slug !== niveauSlug && (
            <>
              <li class="separator">/</li>
              <li><a href={`${rootUrl}${niveauSlug}/`}>{niveauLabel}</a></li>
            </>
          )}
          <li class="separator">/</li>
          <li class="current" aria-current="page">
            {title}
            <SubthemeInfo info={info} Content={indexContent} />
          </li>
        </ol>
      </nav>
      <h1>{title}</h1>
    </header>

    <main class="etiquettes-grid">
      <slot />
    </main>

    <footer><slot name="footer" /></footer>
  </body>
</html>

<style>
/* ... Styles inchang√©s ... */
.layout-header-simple { display: flex; flex-direction: column; gap: var(--space-2); margin-bottom: var(--space-6); }
.breadcrumb ol { display: flex; flex-wrap: wrap; align-items: center; list-style: none; padding: 0; margin: 0; font-size: var(--text-sm); color: var(--color-gray-500); }
.breadcrumb a { color: var(--color-gray-600); text-decoration: none; transition: color 0.2s; }
.breadcrumb a:hover { color: var(--color-guide-primary); text-decoration: underline; }
.breadcrumb .separator { margin: 0 var(--space-2); color: var(--color-gray-400); font-size: 0.8em; }
.breadcrumb .current { font-weight: var(--font-bold); color: var(--color-gray-900); display: flex; align-items: center; }
.header-main h1 { margin: 0; font-size: clamp(var(--text-2xl), 4vw, var(--text-4xl)); font-weight: var(--font-black); color: var(--color-guide-primary); line-height: var(--leading-tight); }
@media print { .breadcrumb { display: none; } .layout-header-simple { margin-bottom: var(--space-4); } }
</style>